# dfgdfgkjasdjqwjqwee1
options {
    sync(0);
    create_dirs(yes);
    dir_perm(0755);
    owner(root);
    group(root);
    perm(0744);
    log_fifo_size(2048);
    chain_hostnames(no);
};

source s_log {unix-stream("/var/syslog");internal();file("/proc/kmsg");};

template t_tem {template("$DATE $FACILITY.$LEVEL $PROGRAM: $MSGONLY\n");template_escape(no);};
template t_tem_server {template("<$PRI>1 $ISODATE $LOCALIP $PROGRAM $PID - [HAG@43119 MAC=\"${MACADDR}\"] $MSGONLY\n");template_escape(no);};
filter f_WANDHCP{program("DHCP");};
filter f_xDSL{program("DSL");};
filter f_ETHER{program("ETHER");};
filter f_SystemMTEN{program("SystemMaintenance");};
filter f_RemoteMGMT{program("RemoteManagement");};
filter f_TR069{program("TR069");};
filter f_NTP{program("NTP");};
filter f_DDNS{program("DDNS");};
filter f_NAT{match("NAT WARNING");};
filter f_NDD{program("NDD") or program("EDR"); };
filter f_VoIPCallStatistics{match("Call Statistics");};
filter f_VoIPSIPCallSignaling{match("SIP Call Signalling");};
filter f_VoIPSIPRegistrations{match("SIP Registration");};
filter f_VoIPPhoneEvent{match("Phone Event");};
filter f_VoIPMisc{match("VoIP Misc");};
filter f_VoIPRestartInfo{match("Restart Info");};
filter f_VoIPPhoneDebug{match("Phone Debug");};
filter f_VoIPVoiceAppDebug{match("VoiceAPP Debug");};
filter f_VoIPCCMDebug{match("CCM Debug");};
filter f_VoIPSIPDebug{match("SIP Debug");};
filter f_VoIPMMDebug{match("MM Debug");};
filter f_VoIPSIPPktDebug{match("SIP Pkt Debug");};
filter f_SystemException{match("System Exception");};
filter f_Attack{match("ATTACK");};
filter f_Acl{match("ACL");};
filter f_CCCLog{match("ccc") and level(err,crit,alert,emerg);};
filter f_BandSteeringLog{program("BandSteering");};

destination d_VoIPCallStatistics{file("/var/log/voip/voip_call_statistics.log" template(t_tem));};
destination d_VoIPSIPCallSignaling{file("/var/log/voip/voip_sip_call_signaling.log" template(t_tem));};
destination d_VoIPSIPRegistrations{file("/var/log/voip/voip_sip_registrations.log" template(t_tem));};
destination d_VoIPPhoneEvent{file("/var/log/voip/voip_phone_event.log" template(t_tem));};
destination d_VoIPMisc{file("/var/log/voip/voip_misc.log" template(t_tem));};
destination d_VoIPRestartInfo{file("/var/log/voip/voip_restart_info.log" template(t_tem));};
destination d_VoIPPhoneDebug{file("/var/log/voip/voip_phone_debug.log" template(t_tem));};
destination d_VoIPVoiceAppDebug{file("/var/log/voip/voip_voiceAPP_debug.log" template(t_tem));};
destination d_VoIPCCMDebug{file("/var/log/voip/voip_ccm_debug.log" template(t_tem));};
destination d_VoIPSIPDebug{file("/var/log/voip/voip_sip_debug.log" template(t_tem));};
destination d_VoIPMMDebug{file("/var/log/voip/voip_mm_debug.log" template(t_tem));};
destination d_VoIPSIPPktDebug{file("/var/log/voip/voip_sip_pkt_debug.log" template(t_tem));};
destination d_Attack{file("/var/log/attack.log" template(t_tem));};
destination d_Acl{file("/var/log/acl.log" template(t_tem));};
destination d_xDSL{file("/var/log/xDSL.log" template(t_tem));};
destination d_WANDHCP{file("/var/log/WANDHCP.log" template(t_tem));};
destination d_ETHER{file("/var/log/ETHER.log" template(t_tem));};
destination d_SystemMTEN{file("/var/log/SystemMTEN.log" template(t_tem));};
destination d_RemoteMGMT{file("/var/log/RemoteMGMT.log" template(t_tem));};
destination d_TR069{file("/var/log/TR069.log" template(t_tem));};
destination d_NTP{file("/var/log/NTP.log" template(t_tem));};
destination d_DDNS{file("/var/log/DDNS.log" template(t_tem));};
destination d_NAT{file("/var/log/NAT.log" template(t_tem));};
destination d_VoIP{file("/var/log/voip/voip.log" template(t_tem));};
destination d_SYSALL{file("/var/log/sysall.log" template(t_tem));};
destination d_CCCLog{file("/var/log/ccc.log" template(t_tem));};
destination d_BandSteeringLog{file("/var/log/bandsteering.log" template(t_tem));};

filter f_emerg {level(emerg);};
filter f_alert {level(alert);};
filter f_crit {level(crit);};
filter f_err {level(err);};
filter f_warn {level(warn);};
filter f_notice {level(notice);};
filter f_info {level(info);};
filter f_debug {level(debug);};

destination d_file{file("/var/log/syslog.log" template(t_tem));};
log {source(s_log); destination(d_file);};
log {source(s_log); filter(f_CCCLog); destination(d_CCCLog); };
log {source(s_log); filter(f_BandSteeringLog); destination(d_BandSteeringLog); };
destination d_server_ndd{udp("SYSLOGSERVER" port(514) template(t_tem_server));};
log {source(s_log); filter(f_NDD); destination(d_server_ndd); };
log {source(s_log); filter(f_VoIPSIPCallSignaling); destination(d_VoIPSIPCallSignaling); };
log {source(s_log); filter(f_VoIPSIPRegistrations); destination(d_VoIPSIPRegistrations); };
log {source(s_log); filter(f_VoIPRestartInfo); destination(d_VoIPRestartInfo); };
filter f_VoIP{match("SIP Call Signalling|SIP Registration|Restart Info"); };
log {source(s_log); filter(f_VoIP); destination(d_VoIP); };
log {source(s_log); filter(f_xDSL); destination(d_xDSL); };
log {source(s_log); filter(f_ETHER); destination(d_ETHER); };
log {source(s_log); filter(f_SystemMTEN); destination(d_SystemMTEN); };
log {source(s_log); filter(f_TR069); destination(d_TR069); };
filter f_SYSALL {program("DSL|ETHER|SystemMaintenance|TR069"); };
log {source(s_log); filter(f_SYSALL); destination(d_SYSALL); };
